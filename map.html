<!DOCTYPE html>
<html>
  <!-- See also: http://kempe.net/blog/2014/06/14/leaflet-pan-zoom-image.html -->
  <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="leaflet/leaflet.css">
    <script src="markers.js"></script>
    <style>
    /*#image-map {
      width: 100%;

      border: 1px solid #ccc;
      margin-bottom: 10px;
    }*/

    body {
        padding: 0;
        margin: 0;
    }
    html, body, #image-map {
        height: 100%;
        width: 100%;
    }

    .leaflet-container {
      background: white;
    }

    </style>
  </head>
  <body>
    <div id="image-map"></div>

    <script src="leaflet/leaflet.js"></script>
    <script>

    // Using leaflet.js to pan and zoom a big image.
    // See also: http://kempe.net/blog/2014/06/14/leaflet-pan-zoom-image.html
    // create the slippy map
    var carte = L.map('image-map', {
      minZoom: 0.7,
      maxZoom: 4,
      center: [0, 0],
      zoom: 0.7,
      crs: L.CRS.Simple
    });
    // dimensions of the image
    var w = 4961,
        h = 3508,
        url = 'images/fond.jpg';
    // calculate the edges of the image, in coordinate space
    var southWest = carte.unproject([0, h], carte.getMaxZoom()-1);
    var northEast = carte.unproject([w, 0], carte.getMaxZoom()-1);
    var bounds = new L.LatLngBounds(southWest, northEast);

    // Adding markers
    // needs a markers array defined e.g.
    /*
    var markers = [
    {
      lat: -438.5,
      lng: 500,
      popup: "<p>hello</p>"
    },
    {
      lat: -97,
      lng: 156,
      popup: "<p>World</p>"
    }];
    */
    var plantList = [];
    var placeList = [];

    plantList = plants.map(customMarker => {
      return L.marker(customMarker).bindPopup(customMarker.popup, { minWidth: 200, keepInView: true})
    });

    placeList = places.map(customMarker => {
      return L.marker(customMarker).bindPopup(customMarker.popup, { minWidth: 200, keepInView: true})
    });

    var plantLayerGroup = L.layerGroup(plantList);
    var placeLayerGroup = L.layerGroup(placeList);

    var overlayMaps = {
      "Plantes": plantLayerGroup.addTo(carte),
      "Am√©nagements": placeLayerGroup
    };

    L.control.layers(null, overlayMaps).addTo(carte);

    // A way to get leaflet coordinates with right click
    carte.on('contextmenu', function(e) {
        alert("Lat, Lon : " + e.latlng.lat + ", " + e.latlng.lng)
    });


    // add the image overlay,
    // so that it covers the entire map
    L.imageOverlay(url, bounds).addTo(carte);
    // tell leaflet that the map is exactly as big as the image
    carte.setMaxBounds(bounds);

    </script>

  </body>
</html>
